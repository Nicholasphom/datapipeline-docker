[2023-06-29T23:27:28.211+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Oracle_to_Filestore.execute_function_task manual__2023-06-29T23:27:26.742579+00:00 [queued]>
[2023-06-29T23:27:28.216+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Oracle_to_Filestore.execute_function_task manual__2023-06-29T23:27:26.742579+00:00 [queued]>
[2023-06-29T23:27:28.216+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 1
[2023-06-29T23:27:28.223+0000] {taskinstance.py:1327} INFO - Executing <Task(_PythonDecoratedOperator): execute_function_task> on 2023-06-29 23:27:26.742579+00:00
[2023-06-29T23:27:28.227+0000] {standard_task_runner.py:57} INFO - Started process 75 to run task
[2023-06-29T23:27:28.230+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'Oracle_to_Filestore', 'execute_function_task', 'manual__2023-06-29T23:27:26.742579+00:00', '--job-id', '603', '--raw', '--subdir', 'DAGS_FOLDER/Python-Delta-Lake/Dags/SparkOracle2FileStoreDag.py', '--cfg-path', '/tmp/tmprsul79ft']
[2023-06-29T23:27:28.231+0000] {standard_task_runner.py:85} INFO - Job 603: Subtask execute_function_task
[2023-06-29T23:27:28.259+0000] {task_command.py:410} INFO - Running <TaskInstance: Oracle_to_Filestore.execute_function_task manual__2023-06-29T23:27:26.742579+00:00 [running]> on host a35364001907
[2023-06-29T23:27:28.306+0000] {taskinstance.py:1545} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='phomsophaN@saccounty.net' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Oracle_to_Filestore' AIRFLOW_CTX_TASK_ID='execute_function_task' AIRFLOW_CTX_EXECUTION_DATE='2023-06-29T23:27:26.742579+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-06-29T23:27:26.742579+00:00'
[2023-06-29T23:27:28.307+0000] {logging_mixin.py:149} INFO - SparkSession Not found, creating one
[2023-06-29T23:27:28.307+0000] {logging_mixin.py:149} INFO - setting up configured spark connection Cluster
[2023-06-29T23:27:28.307+0000] {logging_mixin.py:149} INFO - Initializing support for delta lake spark context
[2023-06-29T23:28:30.872+0000] {logging_mixin.py:149} INFO - Could not build spark context:An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.lang.IllegalArgumentException: requirement failed: Can only call getServletHandlers on a running MetricsSystem
	at scala.Predef$.require(Predef.scala:281)
	at org.apache.spark.metrics.MetricsSystem.getServletHandlers(MetricsSystem.scala:89)
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:650)
	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:238)
	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2023-06-29T23:28:30.873+0000] {client.py:192} INFO - Instantiated <InsecureClient(url='http://namenode:50070')>.
[2023-06-29T23:28:30.874+0000] {client.py:1123} INFO - Listing '/'.
[2023-06-29T23:28:30.876+0000] {logging_mixin.py:149} INFO - Cannot Establish HDFS connection: HTTPConnectionPool(host='namenode', port=50070): Max retries exceeded with url: /webhdfs/v1/?user.name=root&op=LISTSTATUS (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7feecde2fd30>: Failed to establish a new connection: [Errno 111] Connection refused'))
[2023-06-29T23:28:30.876+0000] {logging_mixin.py:149} INFO - HDFS Not Connected
[2023-06-29T23:28:30.877+0000] {logging_mixin.py:149} INFO - SparkSession Not found, creating one
[2023-06-29T23:28:30.877+0000] {logging_mixin.py:149} INFO - SparkSession Not found, creating one
[2023-06-29T23:28:30.877+0000] {logging_mixin.py:149} INFO - setting up configured spark connection Cluster
[2023-06-29T23:28:30.877+0000] {logging_mixin.py:149} INFO - Initializing support for delta lake spark context
[2023-06-29T23:29:30.956+0000] {logging_mixin.py:149} INFO - Could not build spark context:An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.lang.IllegalArgumentException: requirement failed: Can only call getServletHandlers on a running MetricsSystem
	at scala.Predef$.require(Predef.scala:281)
	at org.apache.spark.metrics.MetricsSystem.getServletHandlers(MetricsSystem.scala:89)
	at org.apache.spark.SparkContext.<init>(SparkContext.scala:650)
	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:238)
	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)
	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2023-06-29T23:29:30.956+0000] {logging_mixin.py:149} INFO - Attempt to read Msql Table by query: select * from DeltaLake.OracleTablesLog
        where OracleRows < 1000000 AND OracleRows > 10000 AND OracleSizeInMB < 2500 AND CountyFilter IS NOT NULL and PrimaryKeyColumn !=''
[2023-06-29T23:29:30.956+0000] {logging_mixin.py:149} INFO - Read on Mssql table failed: 'NoneType' object has no attribute 'read'
[2023-06-29T23:29:30.956+0000] {SparkOracle2FileStore.py:177} INFO - Error Running Pipeline:'NoneType' object has no attribute 'toPandas'
[2023-06-29T23:29:30.956+0000] {python.py:183} INFO - Done. Returned value was: None
[2023-06-29T23:29:30.962+0000] {taskinstance.py:1345} INFO - Marking task as SUCCESS. dag_id=Oracle_to_Filestore, task_id=execute_function_task, execution_date=20230629T232726, start_date=20230629T232728, end_date=20230629T232930
[2023-06-29T23:29:31.005+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2023-06-29T23:29:31.014+0000] {taskinstance.py:2651} INFO - 0 downstream tasks scheduled from follow-on schedule check
