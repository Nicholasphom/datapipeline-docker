[2023-07-12T23:43:45.399+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Oracle_to_Filestore_Concurrent.process_bottom_list manual__2023-07-12T23:43:43.120479+00:00 [queued]>
[2023-07-12T23:43:45.404+0000] {taskinstance.py:1103} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Oracle_to_Filestore_Concurrent.process_bottom_list manual__2023-07-12T23:43:43.120479+00:00 [queued]>
[2023-07-12T23:43:45.404+0000] {taskinstance.py:1308} INFO - Starting attempt 1 of 1
[2023-07-12T23:43:45.410+0000] {taskinstance.py:1327} INFO - Executing <Task(_PythonDecoratedOperator): process_bottom_list> on 2023-07-12 23:43:43.120479+00:00
[2023-07-12T23:43:45.414+0000] {standard_task_runner.py:57} INFO - Started process 74 to run task
[2023-07-12T23:43:45.416+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'Oracle_to_Filestore_Concurrent', 'process_bottom_list', 'manual__2023-07-12T23:43:43.120479+00:00', '--job-id', '1164', '--raw', '--subdir', 'DAGS_FOLDER/Python-Delta-Lake/Dags/SparkOracle2FileStoreDag.py', '--cfg-path', '/tmp/tmp8hz_nmss']
[2023-07-12T23:43:45.418+0000] {standard_task_runner.py:85} INFO - Job 1164: Subtask process_bottom_list
[2023-07-12T23:43:45.446+0000] {task_command.py:410} INFO - Running <TaskInstance: Oracle_to_Filestore_Concurrent.process_bottom_list manual__2023-07-12T23:43:43.120479+00:00 [running]> on host c87447a19a28
[2023-07-12T23:43:45.591+0000] {taskinstance.py:1545} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='phomsophaN@saccounty.net' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Oracle_to_Filestore_Concurrent' AIRFLOW_CTX_TASK_ID='process_bottom_list' AIRFLOW_CTX_EXECUTION_DATE='2023-07-12T23:43:43.120479+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2023-07-12T23:43:43.120479+00:00'
[2023-07-12T23:43:55.601+0000] {logging_mixin.py:149} INFO - SparkSession Not found, creating one
[2023-07-12T23:43:55.601+0000] {logging_mixin.py:149} INFO - setting up configured spark connection Cluster
[2023-07-12T23:43:55.601+0000] {logging_mixin.py:149} INFO - Initializing support for delta lake spark context
[2023-07-12T23:43:57.765+0000] {logging_mixin.py:149} INFO - Returning Spark Context
[2023-07-12T23:43:57.765+0000] {logging_mixin.py:149} INFO - Spark Connection check - session found
[2023-07-12T23:43:58.179+0000] {logging_mixin.py:149} INFO - Attempt to read Msql Table by query: select TABLE_NAME, OWNER, OracleRows, PrimaryKeyColumn, CountyFilter,FilterQueryInput,FilterQueryOutput from DeltaLake.OracleTablesLog
        where OracleRows < 10000000 AND OracleRows > 0  and PrimaryKeyColumn !=''
[2023-07-12T23:44:01.602+0000] {SparkOracle2FileStore.py:84} INFO - Skipping log tables and reading tables directly
[2023-07-12T23:44:01.603+0000] {SparkOracle2FileStore.py:94} INFO - processing 1 out of 369
[2023-07-12T23:44:01.603+0000] {logging_mixin.py:149} INFO - Attempting to get lowest value by column ID on table PR_LRS.DEEMED_ELIG
[2023-07-12T23:44:01.604+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:03.385+0000] {logging_mixin.py:149} INFO - Attempting to get max value by column ID on table PR_LRS.DEEMED_ELIG
[2023-07-12T23:44:03.386+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:04.590+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table...
[2023-07-12T23:44:05.144+0000] {SparkOracle2FileStore.py:112} INFO - Filter Processor Activated
[2023-07-12T23:44:05.144+0000] {SparkOracle2FileStore.py:113} INFO - Attempting to Filter by CountyFilter...
[2023-07-12T23:44:05.144+0000] {SparkOracle2FileStore.py:125} INFO - Filter Processor by CountyFilter Failed :condition should be string or Column
[2023-07-12T23:44:05.144+0000] {SparkOracle2FileStore.py:126} INFO - Attempting to Filter by Filter Query Input 
[2023-07-12T23:44:05.145+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:05.166+0000] {logging_mixin.py:149} INFO - Error in reading oracle table by query: An error occurred while calling o114.load.
: java.lang.NullPointerException
	at java.base/java.util.concurrent.ConcurrentHashMap.putVal(ConcurrentHashMap.java:1011)
	at java.base/java.util.concurrent.ConcurrentHashMap.put(ConcurrentHashMap.java:1006)
	at java.base/java.util.Properties.put(Properties.java:1340)
	at java.base/java.util.Properties.setProperty(Properties.java:228)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions.$anonfun$asProperties$1(JDBCOptions.scala:52)
	at scala.collection.immutable.Map$Map4.foreach(Map.scala:493)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions.<init>(JDBCOptions.scala:52)
	at org.apache.spark.sql.execution.datasources.jdbc.JDBCOptions.<init>(JDBCOptions.scala:39)
	at org.apache.spark.sql.execution.datasources.jdbc.JdbcRelationProvider.createRelation(JdbcRelationProvider.scala:34)
	at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:350)
	at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:228)
	at org.apache.spark.sql.DataFrameReader.$anonfun$load$2(DataFrameReader.scala:210)
	at scala.Option.getOrElse(Option.scala:189)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:210)
	at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:171)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:829)
[2023-07-12T23:44:05.166+0000] {SparkOracle2FileStore.py:137} INFO - Filter Processor by Filter Query Input Failed :'NoneType' object has no attribute 'count'
[2023-07-12T23:44:05.167+0000] {SparkOracle2FileStore.py:138} INFO - Attempting to Filter by Filter Query Output 
[2023-07-12T23:44:05.167+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:22.831+0000] {SparkOracle2FileStore.py:143} INFO - Attempting to Filter by FilterQueryOutput Success!
[2023-07-12T23:44:22.832+0000] {logging_mixin.py:149} INFO - Attempting to read oracle rowcount by query...
[2023-07-12T23:44:24.161+0000] {SparkOracle2FileStore.py:144} INFO - Original Count : 665429 Filter Row Count: 982
[2023-07-12T23:44:24.161+0000] {logging_mixin.py:149} INFO - Attempting to read oracle rowcount by query...
[2023-07-12T23:44:25.778+0000] {SparkOracle2FileStore.py:159} INFO - 665429
[2023-07-12T23:44:25.778+0000] {logging_mixin.py:149} INFO - Attempting to read oracle rowcount by query...
[2023-07-12T23:44:27.058+0000] {logging_mixin.py:149} INFO - Checking if directory exists:/home/nicholas/dev/output/DEEMED_ELIG
[2023-07-12T23:44:27.058+0000] {logging_mixin.py:149} INFO - Returning True
[2023-07-12T23:44:27.058+0000] {SparkOracle2FileStore.py:221} INFO - Should not go in here if table dir exists
[2023-07-12T23:44:27.058+0000] {SparkOracle2FileStore.py:222} INFO - Overwriting table since ForceTable is enabled or directory does not exist, check logs
[2023-07-12T23:44:52.275+0000] {SparkOracle2FileStore.py:227} INFO - Table Processing complete for PR_LRS.DEEMED_ELIG
[2023-07-12T23:44:52.390+0000] {SparkOracle2FileStore.py:94} INFO - processing 2 out of 369
[2023-07-12T23:44:52.390+0000] {logging_mixin.py:149} INFO - Attempting to get lowest value by column ID on table PR_LRS.SUBSCR_SCHED
[2023-07-12T23:44:52.390+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:53.520+0000] {logging_mixin.py:149} INFO - Attempting to get max value by column ID on table PR_LRS.SUBSCR_SCHED
[2023-07-12T23:44:53.520+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:54.697+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table...
[2023-07-12T23:44:55.213+0000] {SparkOracle2FileStore.py:112} INFO - Filter Processor Activated
[2023-07-12T23:44:55.214+0000] {SparkOracle2FileStore.py:113} INFO - Attempting to Filter by CountyFilter...
[2023-07-12T23:44:55.214+0000] {SparkOracle2FileStore.py:125} INFO - Filter Processor by CountyFilter Failed :condition should be string or Column
[2023-07-12T23:44:55.214+0000] {SparkOracle2FileStore.py:126} INFO - Attempting to Filter by Filter Query Input 
[2023-07-12T23:44:55.214+0000] {logging_mixin.py:149} INFO - Attempting to read oracle table by query...
[2023-07-12T23:44:56.339+0000] {SparkOracle2FileStore.py:131} INFO - Attempting to Filter by FilterQueryInput Success!
[2023-07-12T23:44:56.339+0000] {logging_mixin.py:149} INFO - Attempting to read oracle rowcount by query...
[2023-07-12T23:44:57.487+0000] {SparkOracle2FileStore.py:132} INFO - Original Count : 2413 Filter Row Count: 0
[2023-07-12T23:44:57.487+0000] {SparkOracle2FileStore.py:134} INFO - Filtered Logs created 0 rows, skipping table
[2023-07-12T23:44:57.487+0000] {python.py:183} INFO - Done. Returned value was: None
[2023-07-12T23:44:57.492+0000] {taskinstance.py:1345} INFO - Marking task as SUCCESS. dag_id=Oracle_to_Filestore_Concurrent, task_id=process_bottom_list, execution_date=20230712T234343, start_date=20230712T234345, end_date=20230712T234457
[2023-07-12T23:44:57.512+0000] {local_task_job_runner.py:225} INFO - Task exited with return code 0
[2023-07-12T23:44:57.522+0000] {taskinstance.py:2651} INFO - 0 downstream tasks scheduled from follow-on schedule check
